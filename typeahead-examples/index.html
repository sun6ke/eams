<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <title>Twitter Typeahead</title>

  <link href="../assets/css/pygments-manni.css" rel="stylesheet">

  <!-- 因为IE9会截断大于250K的CSS，所以将CSS拆分成两个 -->
  <link href="../dist/css/eams-ui.css" rel="stylesheet">
  <link href="../dist/css/eams-ui-plugin.css" rel="stylesheet">
  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="../dist/js/html5shiv.min.js"></script>
  <script src="../dist/js/respond.min.js"></script>
  <![endif]-->

  <script src="../dist/js/eams-ui.js"></script>
  <!--
  JS前端组件国际化
  可以使用 eams-ui.en.js 或者 eams-ui.zh.js
  -->
  <script src="../dist/js/eams-ui.zh.js"></script>
  <script src="../dist/js/echarts-all.js"></script>
</head>

<body>

<div class="container-fluid">
    <div class="row">
  <div class="col-sm-12">
    <section>
      <h2>Twitter Typeahead</h2>

      <p>
        Doc:
        <a target="_blank" href="http://twitter.github.io/typeahead.js/">Twitter Typeahead examples</a>,
        <a target="_blank" href="https://github.com/twitter/typeahead.js/blob/master/doc/jquery_typeahead.md">Typeahead doc</a>,
        <a target="_blank" href="https://github.com/twitter/typeahead.js/blob/master/doc/bloodhound.md">Bloodhound doc</a>
      </p>

    </section>
  </div>
</div>

<div class="row">
  <div class="col-sm-12">

    <h3>local</h3>

    <p>
      被搜索数据(datum)一开始初始化在本地，不到去查询
    </p>

    <div id="local">
  <input class="typeahead" type="text" placeholder="cities">
</div>

<script>
  $(function () {
    var cities = new Bloodhound({
      // 因为city是json对象，所以取它的name属性作为被搜索项
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace("name"),
      // 将查询条件根据空格分开
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      // 给被查询数据(datum)city设置唯一的id
      identify: function (datum) {
        return datum.id;
      },
      local: [
        { "id": "Alabama", "name": "Alabama" },
        { "id": "Alaska", "name": "Alaska" },
        { "id": "Arizona", "name": "Arizona" },
        { "id": "Arkansas", "name": "Arkansas" },
        { "id": "California", "name": "California" },
        { "id": "Colorado", "name": "Colorado" },
        { "id": "Connecticut", "name": "Connecticut" },
        { "id": "Delaware", "name": "Delaware" }
      ]
    });

    $('#local .typeahead').typeahead(null, {
      // dataset的名字
      name: 'cities',
      // 因为返回的数据(datum)是json对象，所以用他的name属性作为显示在input输入框的值
      display: 'name',
      // 数据源，Bloodhound(cities)
      source: cities
    });
  })
</script>

    <br/>
    <div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"local"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">"typeahead"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">placeholder=</span><span class="s">"cities"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;script&gt;</span>
  <span class="nx">$</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">cities</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Bloodhound</span><span class="p">({</span>
      <span class="c1">// 因为city是json对象，所以取它的name属性作为被搜索项</span>
      <span class="na">datumTokenizer</span><span class="p">:</span> <span class="nx">Bloodhound</span><span class="p">.</span><span class="nx">tokenizers</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">whitespace</span><span class="p">(</span><span class="s2">"name"</span><span class="p">),</span>
      <span class="c1">// 将查询条件根据空格分开</span>
      <span class="na">queryTokenizer</span><span class="p">:</span> <span class="nx">Bloodhound</span><span class="p">.</span><span class="nx">tokenizers</span><span class="p">.</span><span class="nx">whitespace</span><span class="p">,</span>
      <span class="c1">// 给被查询数据(datum)city设置唯一的id</span>
      <span class="na">identify</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">datum</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">datum</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
      <span class="p">},</span>
      <span class="na">local</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">"id"</span><span class="p">:</span> <span class="s2">"Alabama"</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Alabama"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">"id"</span><span class="p">:</span> <span class="s2">"Alaska"</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Alaska"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">"id"</span><span class="p">:</span> <span class="s2">"Arizona"</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Arizona"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">"id"</span><span class="p">:</span> <span class="s2">"Arkansas"</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Arkansas"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">"id"</span><span class="p">:</span> <span class="s2">"California"</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"California"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">"id"</span><span class="p">:</span> <span class="s2">"Colorado"</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Colorado"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">"id"</span><span class="p">:</span> <span class="s2">"Connecticut"</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Connecticut"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">"id"</span><span class="p">:</span> <span class="s2">"Delaware"</span><span class="p">,</span> <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"Delaware"</span> <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">});</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">'#local .typeahead'</span><span class="p">).</span><span class="nx">typeahead</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span>
      <span class="c1">// dataset的名字</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'cities'</span><span class="p">,</span>
      <span class="c1">// 因为返回的数据(datum)是json对象，所以用他的name属性作为显示在input输入框的值</span>
      <span class="na">display</span><span class="p">:</span> <span class="s1">'name'</span><span class="p">,</span>
      <span class="c1">// 数据源，Bloodhound(cities)</span>
      <span class="na">source</span><span class="p">:</span> <span class="nx">cities</span>
    <span class="p">});</span>
  <span class="p">})</span>
<span class="nt">&lt;/script&gt;</span></code></pre></div>

  </div>
</div>

<div class="row">
  <div class="col-sm-12">

    <h3>prefetch</h3>

    <p>
      这个例子使用prefetch预先加载了一部分数据，可以降低网络请求次数
    </p>

    <div id="prefetch">
  <input class="typeahead" type="text" placeholder="cities">
</div>

<script>
  $(function () {
    var cities = new Bloodhound({
      // 因为city是json对象，不是一个字符串，所以取它的name属性作为被搜索项
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace("name"),
      // 将查询条件根据空格分开
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      // 给被查询数据(datum)city设置唯一的id
      identify: function (datum) {
        return datum.id;
      },
      prefetch: {
        //  预抓取的数据
        url: 'cities.json',
        // 关闭cache，这样就不会使用localStorage来存储
        cache: false
      }
    });

    $('#prefetch .typeahead').typeahead(null, {
      // dataset的名字
      name: 'cities',
      // 因为返回的数据(datum)是json对象，所以用他的name属性作为显示在input输入框的值
      display: 'name',
      // 数据源，Bloodhound(cities)
      source: cities
    });
  });
</script>

    <br/>
    <div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"prefetch"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">"typeahead"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">placeholder=</span><span class="s">"cities"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;script&gt;</span>
  <span class="nx">$</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">cities</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Bloodhound</span><span class="p">({</span>
      <span class="c1">// 因为city是json对象，不是一个字符串，所以取它的name属性作为被搜索项</span>
      <span class="na">datumTokenizer</span><span class="p">:</span> <span class="nx">Bloodhound</span><span class="p">.</span><span class="nx">tokenizers</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">whitespace</span><span class="p">(</span><span class="s2">"name"</span><span class="p">),</span>
      <span class="c1">// 将查询条件根据空格分开</span>
      <span class="na">queryTokenizer</span><span class="p">:</span> <span class="nx">Bloodhound</span><span class="p">.</span><span class="nx">tokenizers</span><span class="p">.</span><span class="nx">whitespace</span><span class="p">,</span>
      <span class="c1">// 给被查询数据(datum)city设置唯一的id</span>
      <span class="na">identify</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">datum</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">datum</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
      <span class="p">},</span>
      <span class="na">prefetch</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1">//  预抓取的数据</span>
        <span class="na">url</span><span class="p">:</span> <span class="s1">'cities.json'</span><span class="p">,</span>
        <span class="c1">// 关闭cache，这样就不会使用localStorage来存储</span>
        <span class="na">cache</span><span class="p">:</span> <span class="kc">false</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">'#prefetch .typeahead'</span><span class="p">).</span><span class="nx">typeahead</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span>
      <span class="c1">// dataset的名字</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'cities'</span><span class="p">,</span>
      <span class="c1">// 因为返回的数据(datum)是json对象，所以用他的name属性作为显示在input输入框的值</span>
      <span class="na">display</span><span class="p">:</span> <span class="s1">'name'</span><span class="p">,</span>
      <span class="c1">// 数据源，Bloodhound(cities)</span>
      <span class="na">source</span><span class="p">:</span> <span class="nx">cities</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span></code></pre></div>

  </div>
</div>

<div class="row">
  <div class="col-sm-12">

    <h3>remote</h3>

    <p>
      当local和prefetch返回的数据(datum)小于 <code>sufficient</code>(默认5)时，会调用到remote
    </p>

    <p>
      这个例子里remote返回的数据总是一样的，在实际开发过程中需要后端自己实现查询逻辑
    </p>

    <div id="remote">
  <input class="typeahead" type="text" placeholder="cities">
</div>

<script>
  $(function () {
    var cities = new Bloodhound({
      // 因为city是json对象，不是一个字符串，所以取它的name属性作为被搜索项
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace("name"),
      // 将查询条件根据空格分开
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      // 给被查询数据(datum)city设置唯一的id
      identify: function (datum) {
        return datum.id;
      },
      remote: {
        // 查询条件会追加在请求url上，比如 cities.json?q=California
        url: 'cities.json?q=%QUERY%',
        wildcard: '%QUERY%'
      }
    });

    $('#remote .typeahead').typeahead(null, {
      // dataset的名字
      name: 'cities',
      // 因为返回的数据(datum)是json对象，所以用他的name属性作为显示在input输入框的值
      display: 'name',
      // 数据源，Bloodhound(cities)
      source: cities
    });
  });
</script>

    <br/>
    <div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"remote"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">"typeahead"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">placeholder=</span><span class="s">"cities"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;script&gt;</span>
  <span class="nx">$</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">cities</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Bloodhound</span><span class="p">({</span>
      <span class="c1">// 因为city是json对象，不是一个字符串，所以取它的name属性作为被搜索项</span>
      <span class="na">datumTokenizer</span><span class="p">:</span> <span class="nx">Bloodhound</span><span class="p">.</span><span class="nx">tokenizers</span><span class="p">.</span><span class="nx">obj</span><span class="p">.</span><span class="nx">whitespace</span><span class="p">(</span><span class="s2">"name"</span><span class="p">),</span>
      <span class="c1">// 将查询条件根据空格分开</span>
      <span class="na">queryTokenizer</span><span class="p">:</span> <span class="nx">Bloodhound</span><span class="p">.</span><span class="nx">tokenizers</span><span class="p">.</span><span class="nx">whitespace</span><span class="p">,</span>
      <span class="c1">// 给被查询数据(datum)city设置唯一的id</span>
      <span class="na">identify</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">datum</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">datum</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
      <span class="p">},</span>
      <span class="na">remote</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1">// 查询条件会追加在请求url上，比如 cities.json?q=California</span>
        <span class="na">url</span><span class="p">:</span> <span class="s1">'cities.json?q=%QUERY%'</span><span class="p">,</span>
        <span class="na">wildcard</span><span class="p">:</span> <span class="s1">'%QUERY%'</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">'#remote .typeahead'</span><span class="p">).</span><span class="nx">typeahead</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span>
      <span class="c1">// dataset的名字</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'cities'</span><span class="p">,</span>
      <span class="c1">// 因为返回的数据(datum)是json对象，所以用他的name属性作为显示在input输入框的值</span>
      <span class="na">display</span><span class="p">:</span> <span class="s1">'name'</span><span class="p">,</span>
      <span class="c1">// 数据源，Bloodhound(cities)</span>
      <span class="na">source</span><span class="p">:</span> <span class="nx">cities</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span></code></pre></div>

  </div>
</div>

</div>

</body>

</html>

